function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function r(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e,t,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=a(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function i(e){return"number"==typeof e?e?e<0?-1:1:e==e?e:NaN:NaN}var u=function(){function t(){e(this,t),this.coefs=[];for(var r=arguments.length-1;r>=0;r--)this.coefs.push(r<0||arguments.length<=r?void 0:arguments[r]);this._variable="t",this._s=0}return r(t,[{key:"clone",value:function(){var e=new t;return e.coefs=this.coefs.slice(),e}},{key:"eval",value:function(e){if(isNaN(e))throw new Error("Polynomial.eval: parameter must be a number");for(var t=0,r=this.coefs.length-1;r>=0;r--)t=t*e+this.coefs[r];return t}},{key:"add",value:function(e){for(var r=new t,a=this.getDegree(),n=e.getDegree(),o=Math.max(a,n),s=0;s<=o;s++){var i=s<=a?this.coefs[s]:0,u=s<=n?e.coefs[s]:0;r.coefs[s]=i+u}return r}},{key:"multiply",value:function(e){for(var r=new t,a=0;a<=this.getDegree()+e.getDegree();a++)r.coefs.push(0);for(var n=0;n<=this.getDegree();n++)for(var o=0;o<=e.getDegree();o++)r.coefs[n+o]+=this.coefs[n]*e.coefs[o];return r}},{key:"divide_scalar",value:function(e){for(var t=0;t<this.coefs.length;t++)this.coefs[t]/=e}},{key:"simplify",value:function(e){void 0===e&&(e=1e-12);for(var t=this.getDegree();t>=0&&Math.abs(this.coefs[t])<=e;t--)this.coefs.pop()}},{key:"bisection",value:function(e,r){var a,n=this.eval(e),o=this.eval(r);if(Math.abs(n)<=t.TOLERANCE)a=e;else if(Math.abs(o)<=t.TOLERANCE)a=r;else if(n*o<=0)for(var s=Math.log(r-e),i=Math.LN10*t.ACCURACY,u=Math.ceil((s+i)/Math.LN2),h=0;h<u;h++){a=.5*(e+r);var f=this.eval(a);if(Math.abs(f)<=t.TOLERANCE)break;f*n<0?(r=a,o=f):(e=a,n=f)}return a}},{key:"toString",value:function(){for(var e=[],t=[],r=this.coefs.length-1;r>=0;r--){var a=Math.round(1e3*this.coefs[r])/1e3;if(0!==a){var n=a<0?" - ":" + ";a=Math.abs(a),r>0&&(1===a?a=this._variable:a+=this._variable),r>1&&(a+="^"+r),t.push(n),e.push(a)}}t[0]=" + "===t[0]?"":"-";for(var o="",s=0;s<e.length;s++)o+=t[s]+e[s];return o}},{key:"trapezoid",value:function(e,t,r){if(isNaN(e)||isNaN(t)||isNaN(r))throw new Error("Polynomial.trapezoid: parameters must be numbers");var a=t-e;if(1===r){var n=this.eval(e),o=this.eval(t);this._s=.5*a*(n+o)}else{for(var s=1<<r-2,i=a/s,u=e+.5*i,h=0,f=0;f<s;f++)h+=this.eval(u),u+=i;this._s=.5*(this._s+a*h/s)}if(isNaN(this._s))throw new Error("Polynomial.trapezoid: this._s is NaN");return this._s}},{key:"simpson",value:function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Polynomial.simpson: parameters must be numbers");for(var r=t-e,a=.5*r*(this.eval(e)+this.eval(t)),n=a,o=4*a/3,s=o,i=a,u=1,h=2;h<=20;h++){for(var f=r/u,c=e+.5*f,l=0,v=1;v<=u;v++)l+=this.eval(c),c+=f;if(o=(4*(a=n=.5*(n+r*l/u))-i)/3,Math.abs(o-s)<1e-7*Math.abs(s))break;s=o,i=a,u<<=1}return o}},{key:"romberg",value:function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Polynomial.romberg: parameters must be numbers");var a=new Array(21),n=new Array(21),o={y:0,dy:0};n[0]=1;for(var s=1;s<=20&&(a[s-1]=this.trapezoid(e,r,s),!(s>=3&&(o=t.interpolate(n,a,3,s-3,0),Math.abs(o.dy)<=1e-6*o.y)));s++)a[s]=a[s-1],n[s]=.25*n[s-1];return o.y}},{key:"getDegree",value:function(){return this.coefs.length-1}},{key:"getDerivative",value:function(){for(var e=new t,r=1;r<this.coefs.length;r++)e.coefs.push(r*this.coefs[r]);return e}},{key:"getRoots",value:function(){var e;switch(this.simplify(),this.getDegree()){case 0:e=[];break;case 1:e=this.getLinearRoot();break;case 2:e=this.getQuadraticRoots();break;case 3:e=this.getCubicRoots();break;case 4:e=this.getQuarticRoots();break;default:e=[]}return e}},{key:"getRootsInInterval",value:function(e,t){var r=[];function a(e){null!==e&&r.push(e)}if(1===this.getDegree())a(this.bisection(e,t));else{var n=this.getDerivative().getRootsInInterval(e,t);if(n.length>0){a(this.bisection(e,n[0]));for(var o=0;o<=n.length-2;o++)a(this.bisection(n[o],n[o+1]));a(this.bisection(n[n.length-1],t))}else a(this.bisection(e,t))}return r}},{key:"getLinearRoot",value:function(){var e=[],t=this.coefs[1];return 0!==t&&e.push(-this.coefs[0]/t),e}},{key:"getQuadraticRoots",value:function(){var e=[];if(2===this.getDegree()){var t=this.coefs[2],r=this.coefs[1]/t,a=r*r-4*(this.coefs[0]/t);if(a>0){var n=Math.sqrt(a);e.push(.5*(-r+n)),e.push(.5*(-r-n))}else 0===a&&e.push(.5*-r)}return e}},{key:"getCubicRoots",value:function(){var e=[];if(3===this.getDegree()){var t=this.coefs[3],r=this.coefs[2]/t,a=this.coefs[1]/t,n=(3*a-r*r)/3,o=(2*r*r*r-9*a*r+27*(this.coefs[0]/t))/27,s=r/3,i=o*o/4+n*n*n/27,u=o/2,h=this.zeroErrorEstimate();if(Math.abs(i)<=h&&(i=0),i>0){var f,c=Math.sqrt(i),l=-u+c;f=l>=0?Math.pow(l,1/3):-Math.pow(-l,1/3),(l=-u-c)>=0?f+=Math.pow(l,1/3):f-=Math.pow(-l,1/3),e.push(f-s)}else if(i<0){var v=Math.sqrt(-n/3),p=Math.atan2(Math.sqrt(-i),-u)/3,b=Math.cos(p),g=Math.sin(p),m=Math.sqrt(3);e.push(2*v*b-s),e.push(-v*(b+m*g)-s),e.push(-v*(b-m*g)-s)}else{var y;y=u>=0?-Math.pow(u,1/3):Math.pow(-u,1/3),e.push(2*y-s),e.push(-y-s)}}return e}},{key:"getQuarticRoots",value:function(){var e=[],r=this.getDegree();if(4===r){var a=new t;a.coefs=this.coefs.slice(),a.divide_scalar(a.coefs[r]);Math.abs(a.coefs[0])<10*1e-15*Math.abs(a.coefs[3])&&(a.coefs[0]=0);for(var n=a.getDerivative(),o=n.getRoots().sort(function(e,t){return e-t}),s=[],u=o.length-1,h=this.bounds(),f=Math.max(Math.abs(h.minX),Math.abs(h.maxX)),c=this.zeroErrorEstimate(f),l=0;l<=u;l++)s.push(a.eval(o[l]));for(var v=0;v<=u;v++)Math.abs(s[v])<c&&(s[v]=0);var p=0,b=Math.max(.1*(h.maxX-h.minX)/r,1e-15),g=[],m=[];if(u>-1){for(0!==s[0]?i(s[0])!==i(a.eval(o[0]-b)-s[0])&&(g.push(o[0]-b),m.push([h.minX,o[0]])):(e.push(o[0],o[0]),p++);p<u;p++)0===s[p+1]?(e.push(o[p+1],o[p+1]),p++):i(s[p])!==i(s[p+1])&&(g.push((o[p]+o[p+1])/2),m.push([o[p],o[p+1]]));0!==s[u]&&i(s[u])!==i(a.eval(o[u]+b)-s[u])&&(g.push(o[u]+b),m.push([o[u],h.maxX]))}var y=function(e){return a.eval(e)},w=function(e){return n.eval(e)};if(g.length>0)for(p=0;p<g.length;p++)g[p]=t.newton_secant_bisection(g[p],y,w,32,m[p][0],m[p][1]);e=e.concat(g)}return e}},{key:"zeroErrorEstimate",value:function(e){if(void 0===e){var t=this.bounds();e=Math.max(Math.abs(t.minX),Math.abs(t.maxX))}if(e<.001)return 2*Math.abs(this.eval(1e-15));var r=this.coefs.length-1,a=this.coefs[r];return 10*1e-15*this.coefs.reduce(function(t,r,n){var o=r/a*Math.pow(e,n);return o>t?o:t},0)}},{key:"bounds_UpperReal_Fujiwara",value:function(){var e=this.coefs,t=e.length-1,r=e[t];1!==r&&(e=this.coefs.map(function(e){return e/r}));var a,n=e.map(function(e,r){return r<t?Math.pow(Math.abs(0===r?e/2:e),1/(t-r)):e}),o=function(e,t,r){return a(r)&&(e.max<t?(e.nearmax=e.max,e.max=t):e.nearmax<t&&(e.nearmax=t)),e};a=function(r){return r<t&&e[r]<0};var s=n.reduce(o,{max:0,nearmax:0});return a=function(r){return r<t&&(t%2==r%2?e[r]<0:e[r]>0)},{negX:-2*n.reduce(o,{max:0,nearmax:0}).max,posX:2*s.max}}},{key:"bounds_LowerReal_Fujiwara",value:function(){var e=new t;e.coefs=this.coefs.slice().reverse();var r=e.bounds_UpperReal_Fujiwara();return r.negX=1/r.negX,r.posX=1/r.posX,r}},{key:"bounds",value:function(){var e=this.bounds_UpperReal_Fujiwara(),t={minX:e.negX,maxX:e.posX};return 0===e.negX&&0===e.posX?t:(0===e.negX?t.minX=this.bounds_LowerReal_Fujiwara().posX:0===e.posX&&(t.maxX=this.bounds_LowerReal_Fujiwara().negX),t.minX>t.maxX&&(t.minX=t.maxX=0),t)}},{key:"modify_zeroSmallCoefs",value:function(){for(var e=this.coefs,t=10*1e-15*Math.abs(e.reduce(function(e,t){return Math.abs(t)>Math.abs(e)?t:e})),r=0;r<e.length-1;r++)Math.abs(e[r])<t&&(e[r]=0);return this}},{key:"modify_toMonic",value:function(){var e=this.coefs;return 1!==e[e.length-1]&&this.divide_scalar(e[e.length-1]),this}},{key:"bound_UpperAbs_Rouche",value:function(){var e=this.coefs,t=e.length-1;return 1+e.reduce(function(e,r,a){return a!==t&&e<(r=Math.abs(r))?r:e},0)/Math.abs(e[t])}},{key:"bound_LowerAbs_Rouche",value:function(){var e=this.coefs,t=e.reduce(function(e,t,r){return 0!==r&&e<(t=Math.abs(t))?t:e},0);return Math.abs(e[0])/(Math.abs(e[0])+t)}},{key:"bounds_Real_Laguerre",value:function(){var e=this.coefs,t=e.length-1,r=-e[t-1]/(t*e[t]),a=e[t-1]*e[t-1]-2*t/(t-1)*e[t]*e[t-2],n=(t-1)/(t*e[t])*Math.sqrt(a);return n<0&&(n=-n),{minX:r-n,maxX:r+n}}},{key:"countRoots_Descartes",value:function(){var e=this.coefs,t=e.length-1,r=e.reduce(function(e,t,r){return 0!==e.prev_a&&0!==t&&(e.prev_a<0==t>0&&e.pos++,r%2==0!=e.prev_a<0==(r%2==1!=t>0)&&e.neg++),e.prev_a=t,e},{pos:0,neg:0,prev_a:0});return{maxRealPos:r.pos,maxRealNeg:r.neg,minComplex:t-(r.pos+r.neg)}}}],[{key:"interpolate",value:function(e,t,r,a,n){if(e.constructor!==Array||t.constructor!==Array)throw new Error("Polynomial.interpolate: xs and ys must be arrays");if(isNaN(r)||isNaN(a)||isNaN(n))throw new Error("Polynomial.interpolate: n, offset, and x must be numbers");var o,s=0,i=0,u=new Array(r),h=new Array(r),f=0,c=Math.abs(n-e[a]);for(o=0;o<r;o++){var l=Math.abs(n-e[a+o]);l<c&&(f=o,c=l),u[o]=h[o]=t[a+o]}s=t[a+f],f--;for(var v=1;v<r;v++){for(o=0;o<r-v;o++){var p=e[a+o]-n,b=e[a+o+v]-n,g=u[o+1]-h[o],m=p-b;if(0===m)throw new Error("Unable to interpolate polynomial. Two numbers in n were identical (to within roundoff)");m=g/m,h[o]=b*m,u[o]=p*m}s+=i=2*(f+1)<r-v?u[f+1]:h[f--]}return{y:s,dy:i}}},{key:"newton_secant_bisection",value:function(e,t,r,a,n,o){var s,u,h,f,c,l,v,p=0,b=0;s=e;var g=Math.pow(10,-14),m="number"==typeof n&&"number"==typeof o;if(m){if(n>o)throw new Error("newton root finding: min must be greater than max");if(l=t(n),v=t(o),i(l)===i(v))throw new Error("newton root finding: y values of bounds must be of opposite sign")}for(var y=function(){return Math.abs(h)<=g*Math.abs(s)||b===s-h-s},w=0;w<a;w++){if(0===(u=r(s))){if(0===p)throw new Error("newton root finding: df(x) is zero");u=p}if(p=u,c=t(s),f=s-(h=c/u),y())break;if(m){if(i(c)===i(v))o=s,v=c;else{if(i(c)!==i(l)){s=f;break}n=s,l=c}if(f<n||f>o){if(i(l)===i(v))break;var M=v-l,d=o-n;if(h=0===M?s-(n+.5*d):Math.abs(M/Math.min(l,v))>50?s-(n+d*(.5+(Math.abs(l)<Math.abs(v)?-.25:.25))):s-(n-l/M*d),f=s-h,y())break}}b=s-f,s=f}return s}}]),t}();u.TOLERANCE=1e-6,u.ACCURACY=15;var h=function(t){function i(){return e(this,i),o(this,a(i).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}(i,u),r(i,[{key:"eval",value:function(e){var t=s(a(i.prototype),"eval",this).call(this,e);if(Math.abs(t)<1e-7&&(t=0),t<0)throw new Error("SqrtPolynomial.eval: cannot take square root of negative number");return Math.sqrt(t)}},{key:"toString",value:function(){return"sqrt("+s(a(i.prototype),"toString",this).call(this)+")"}}]),i}();export{u as Polynomial,h as SqrtPolynomial};
//# sourceMappingURL=index-esm.min.js.map
