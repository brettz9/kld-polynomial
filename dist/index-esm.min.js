function t(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.init(e)}function e(t){return"number"==typeof t?t?t<0?-1:1:t==t?t:NaN:NaN}function r(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.init(e)}t.TOLERANCE=1e-6,t.ACCURACY=15,t.interpolate=function(t,e,r,o,a){if(t.constructor!==Array||e.constructor!==Array)throw new Error("Polynomial.interpolate: xs and ys must be arrays");if(isNaN(r)||isNaN(o)||isNaN(a))throw new Error("Polynomial.interpolate: n, offset, and x must be numbers");var s,i=0,n=0,h=new Array(r),f=new Array(r),u=0,p=Math.abs(a-t[o]);for(s=0;s<r;s++){var c=Math.abs(a-t[o+s]);c<p&&(u=s,p=c),h[s]=f[s]=e[o+s]}i=e[o+u],u--;for(var l=1;l<r;l++){for(s=0;s<r-l;s++){var v=t[o+s]-a,b=t[o+s+l]-a,m=h[s+1]-f[s],g=v-b;if(0===g)throw new Error("Unable to interpolate polynomial. Two numbers in n were identical (to within roundoff)");g=m/g,f[s]=b*g,h[s]=v*g}i+=n=2*(u+1)<r-l?h[u+1]:f[u--]}return{y:i,dy:n}},t.prototype.init=function(t){this.coefs=[];for(var e=t.length-1;e>=0;e--)this.coefs.push(t[e]);this._variable="t",this._s=0},t.prototype.eval=function(t){if(isNaN(t))throw new Error("Polynomial.eval: parameter must be a number");for(var e=0,r=this.coefs.length-1;r>=0;r--)e=e*t+this.coefs[r];return e},t.prototype.add=function(e){for(var r=new t,o=this.getDegree(),a=e.getDegree(),s=Math.max(o,a),i=0;i<=s;i++){var n=i<=o?this.coefs[i]:0,h=i<=a?e.coefs[i]:0;r.coefs[i]=n+h}return r},t.prototype.multiply=function(e){for(var r=new t,o=0;o<=this.getDegree()+e.getDegree();o++)r.coefs.push(0);for(var a=0;a<=this.getDegree();a++)for(var s=0;s<=e.getDegree();s++)r.coefs[a+s]+=this.coefs[a]*e.coefs[s];return r},t.prototype.divide_scalar=function(t){for(var e=0;e<this.coefs.length;e++)this.coefs[e]/=t},t.prototype.simplify=function(t){void 0===t&&(t=1e-12);for(var e=this.getDegree();e>=0&&Math.abs(this.coefs[e])<=t;e--)this.coefs.pop()},t.prototype.bisection=function(e,r){var o,a=this.eval(e),s=this.eval(r);if(Math.abs(a)<=t.TOLERANCE)o=e;else if(Math.abs(s)<=t.TOLERANCE)o=r;else if(a*s<=0)for(var i=Math.log(r-e),n=Math.LN10*t.ACCURACY,h=Math.ceil((i+n)/Math.LN2),f=0;f<h;f++){o=.5*(e+r);var u=this.eval(o);if(Math.abs(u)<=t.TOLERANCE)break;u*a<0?(r=o,s=u):(e=o,a=u)}return o},t.prototype.toString=function(){for(var t=[],e=[],r=this.coefs.length-1;r>=0;r--){var o=Math.round(1e3*this.coefs[r])/1e3;if(0!==o){var a=o<0?" - ":" + ";o=Math.abs(o),r>0&&(1===o?o=this._variable:o+=this._variable),r>1&&(o+="^"+r),e.push(a),t.push(o)}}e[0]=" + "===e[0]?"":"-";for(var s="",i=0;i<t.length;i++)s+=e[i]+t[i];return s},t.prototype.trapezoid=function(t,e,r){if(isNaN(t)||isNaN(e)||isNaN(r))throw new Error("Polynomial.trapezoid: parameters must be numbers");var o=e-t;if(1===r){var a=this.eval(t),s=this.eval(e);this._s=.5*o*(a+s)}else{for(var i=1<<r-2,n=o/i,h=t+.5*n,f=0,u=0;u<i;u++)f+=this.eval(h),h+=n;this._s=.5*(this._s+o*f/i)}if(isNaN(this._s))throw new Error("Polynomial.trapezoid: this._s is NaN");return this._s},t.prototype.simpson=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Polynomial.simpson: parameters must be numbers");for(var r=e-t,o=.5*r*(this.eval(t)+this.eval(e)),a=o,s=4*o/3,i=s,n=o,h=1,f=2;f<=20;f++){for(var u=r/h,p=t+.5*u,c=0,l=1;l<=h;l++)c+=this.eval(p),p+=u;if(s=(4*(o=a=.5*(a+r*c/h))-n)/3,Math.abs(s-i)<1e-7*Math.abs(i))break;i=s,n=o,h<<=1}return s},t.prototype.romberg=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Polynomial.romberg: parameters must be numbers");var o=new Array(21),a=new Array(21),s={y:0,dy:0};a[0]=1;for(var i=1;i<=20&&(o[i-1]=this.trapezoid(e,r,i),!(i>=3&&(s=t.interpolate(a,o,3,i-3,0),Math.abs(s.dy)<=1e-6*s.y)));i++)o[i]=o[i-1],a[i]=.25*a[i-1];return s.y},t.prototype.getDegree=function(){return this.coefs.length-1},t.prototype.getDerivative=function(){for(var e=new t,r=1;r<this.coefs.length;r++)e.coefs.push(r*this.coefs[r]);return e},t.prototype.getRoots=function(){var t;switch(this.simplify(),this.getDegree()){case 0:t=[];break;case 1:t=this.getLinearRoot();break;case 2:t=this.getQuadraticRoots();break;case 3:t=this.getCubicRoots();break;case 4:t=this.getQuarticRoots();break;default:t=[]}return t},t.prototype.getRootsInInterval=function(t,e){var r=[];function o(t){null!==t&&r.push(t)}if(1===this.getDegree())o(this.bisection(t,e));else{var a=this.getDerivative().getRootsInInterval(t,e);if(a.length>0){o(this.bisection(t,a[0]));for(var s=0;s<=a.length-2;s++)o(this.bisection(a[s],a[s+1]));o(this.bisection(a[a.length-1],e))}else o(this.bisection(t,e))}return r},t.prototype.getLinearRoot=function(){var t=[],e=this.coefs[1];return 0!==e&&t.push(-this.coefs[0]/e),t},t.prototype.getQuadraticRoots=function(){var t=[];if(2===this.getDegree()){var e=this.coefs[2],r=this.coefs[1]/e,o=r*r-4*(this.coefs[0]/e);if(o>0){var a=Math.sqrt(o);t.push(.5*(-r+a)),t.push(.5*(-r-a))}else 0===o&&t.push(.5*-r)}return t},t.prototype.getCubicRoots=function(){var t=[];if(3===this.getDegree()){var e=this.coefs[3],r=this.coefs[2]/e,o=this.coefs[1]/e,a=(3*o-r*r)/3,s=(2*r*r*r-9*o*r+27*(this.coefs[0]/e))/27,i=r/3,n=s*s/4+a*a*a/27,h=s/2,f=this.zeroErrorEstimate();if(Math.abs(n)<=f&&(n=0),n>0){var u,p=Math.sqrt(n),c=-h+p;u=c>=0?Math.pow(c,1/3):-Math.pow(-c,1/3),(c=-h-p)>=0?u+=Math.pow(c,1/3):u-=Math.pow(-c,1/3),t.push(u-i)}else if(n<0){var l=Math.sqrt(-a/3),v=Math.atan2(Math.sqrt(-n),-h)/3,b=Math.cos(v),m=Math.sin(v),g=Math.sqrt(3);t.push(2*l*b-i),t.push(-l*(b+g*m)-i),t.push(-l*(b-g*m)-i)}else{var w;w=h>=0?-Math.pow(h,1/3):Math.pow(-h,1/3),t.push(2*w-i),t.push(-w-i)}}return t},t.prototype.getQuarticRoots=function(){var r=[],o=this.getDegree();if(4===o){var a=new t;a.coefs=this.coefs.slice(),a.divide_scalar(a.coefs[o]);Math.abs(a.coefs[0])<10*1e-15*Math.abs(a.coefs[3])&&(a.coefs[0]=0);for(var s=a.getDerivative(),i=s.getRoots().sort(function(t,e){return t-e}),n=[],h=i.length-1,f=this.bounds(),u=Math.max(Math.abs(f.minX),Math.abs(f.maxX)),p=this.zeroErrorEstimate(u),c=0;c<=h;c++)n.push(a.eval(i[c]));for(var l=0;l<=h;l++)Math.abs(n[l])<p&&(n[l]=0);var v=0,b=Math.max(.1*(f.maxX-f.minX)/o,1e-15),m=[],g=[];if(h>-1){for(0!==n[0]?e(n[0])!==e(a.eval(i[0]-b)-n[0])&&(m.push(i[0]-b),g.push([f.minX,i[0]])):(r.push(i[0],i[0]),v++);v<h;v++)0===n[v+1]?(r.push(i[v+1],i[v+1]),v++):e(n[v])!==e(n[v+1])&&(m.push((i[v]+i[v+1])/2),g.push([i[v],i[v+1]]));0!==n[h]&&e(n[h])!==e(a.eval(i[h]+b)-n[h])&&(m.push(i[h]+b),g.push([i[h],f.maxX]))}var w=function(t){return a.eval(t)},y=function(t){return s.eval(t)};if(m.length>0)for(v=0;v<m.length;v++)m[v]=t.newton_secant_bisection(m[v],w,y,32,g[v][0],g[v][1]);r=r.concat(m)}return r},t.prototype.zeroErrorEstimate=function(t){if(void 0===t){var e=this.bounds();t=Math.max(Math.abs(e.minX),Math.abs(e.maxX))}if(t<.001)return 2*Math.abs(this.eval(1e-15));var r=this.coefs.length-1,o=this.coefs[r];return 10*1e-15*this.coefs.reduce(function(e,r,a){var s=r/o*Math.pow(t,a);return s>e?s:e},0)},t.prototype.bounds_UpperReal_Fujiwara=function(){var t=this.coefs,e=t.length-1,r=t[e];1!==r&&(t=this.coefs.map(function(t){return t/r}));var o,a=t.map(function(t,r){return r<e?Math.pow(Math.abs(0===r?t/2:t),1/(e-r)):t}),s=function(t,e,r){return o(r)&&(t.max<e?(t.nearmax=t.max,t.max=e):t.nearmax<e&&(t.nearmax=e)),t};o=function(r){return r<e&&t[r]<0};var i=a.reduce(s,{max:0,nearmax:0});return o=function(r){return r<e&&(e%2==r%2?t[r]<0:t[r]>0)},{negX:-2*a.reduce(s,{max:0,nearmax:0}).max,posX:2*i.max}},t.prototype.bounds_LowerReal_Fujiwara=function(){var e=new t;e.coefs=this.coefs.slice().reverse();var r=e.bounds_UpperReal_Fujiwara();return r.negX=1/r.negX,r.posX=1/r.posX,r},t.prototype.bounds=function(){var t=this.bounds_UpperReal_Fujiwara(),e={minX:t.negX,maxX:t.posX};return 0===t.negX&&0===t.posX?e:(0===t.negX?e.minX=this.bounds_LowerReal_Fujiwara().posX:0===t.posX&&(e.maxX=this.bounds_LowerReal_Fujiwara().negX),e.minX>e.maxX&&(e.minX=e.maxX=0),e)},t.newton_secant_bisection=function(t,r,o,a,s,i){var n,h,f,u,p,c,l,v=0,b=0;n=t;var m=Math.pow(10,-14),g="number"==typeof s&&"number"==typeof i;if(g){if(s>i)throw new Error("newton root finding: min must be greater than max");if(c=r(s),l=r(i),e(c)===e(l))throw new Error("newton root finding: y values of bounds must be of opposite sign")}for(var w=function(){return Math.abs(f)<=m*Math.abs(n)||b===n-f-n},y=0;y<a;y++){if(0===(h=o(n))){if(0===v)throw new Error("newton root finding: df(x) is zero");h=v}if(v=h,p=r(n),u=n-(f=p/h),w())break;if(g){if(e(p)===e(l))i=n,l=p;else{if(e(p)!==e(c)){n=u;break}s=n,c=p}if(u<s||u>i){if(e(c)===e(l))break;var M=l-c,d=i-s;if(f=0===M?n-(s+.5*d):Math.abs(M/Math.min(c,l))>50?n-(s+d*(.5+(Math.abs(c)<Math.abs(l)?-.25:.25))):n-(s-c/M*d),u=n-f,w())break}}b=n-u,n=u}return n},r.VERSION=1,r.prototype=new t,r.prototype.constructor=r,r.superclass=t.prototype,r.prototype.eval=function(t){var e=r.superclass.eval.call(this,t);if(Math.abs(e)<1e-7&&(e=0),e<0)throw new Error("SqrtPolynomial.eval: cannot take square root of negative number");return Math.sqrt(e)},r.prototype.toString=function(){return"sqrt("+r.superclass.toString.call(this)+")"};export{t as Polynomial,r as SqrtPolynomial};
//# sourceMappingURL=index-esm.min.js.map
